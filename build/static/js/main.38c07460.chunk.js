(this.webpackJsonplaunches=this.webpackJsonplaunches||[]).push([[0],{23:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),s=n(15),a=n.n(s),i=(n(23),n(3)),l=n(7),o=n(2),u=n(0),j=function(e){var t=e.launches;return Object(u.jsx)("div",{className:"launch-feed",children:t.slice(0).reverse().map((function(e,t){return Object(u.jsx)("div",{className:"launch-preview",children:Object(u.jsxs)(l.b,{to:"/launch/".concat(e.id),children:[Object(u.jsx)("h2",{children:e.name}),Object(u.jsx)("h4",{children:e.date_utc.substring(0,10)}),Object(u.jsx)("p",{children:e.details.substring(0,200)+"..."})]})},t)}))})},d=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)(!0),l=Object(i.a)(a,2),o=l[0],u=l[1],j=Object(c.useState)(null),d=Object(i.a)(j,2),b=d[0],h=d[1];return Object(c.useEffect)((function(){var t=new AbortController;return fetch(e,{signal:t.signal}).then((function(e){if(!e.ok)throw Error("could not fetch the data");return e.json()})).then((function(e){s(e),u(!1),h(null)})).catch((function(e){"AbortError"===e.name?console.log("fetch aborted"):(h(e.message),u(!1))})),function(){return t.abort()}}),[e]),{data:r,isPending:o,error:b}},b=function(){var e=d("https://api.spacexdata.com/v5/launches/upcoming"),t=e.data,n=e.isPending,r=e.error,s=Object(c.useState)(""),a=Object(i.a)(s,2),l=a[0],o=a[1];return Object(c.useEffect)((function(){var e=setInterval((function(){if(t){var n=(new Date).getTime(),c=new Date(t[0].date_utc).getTime()-n,r=Math.floor(c/864e5),s=Math.floor(c%864e5/36e5),a=Math.floor(c%36e5/6e4),i=Math.floor(c%6e4/1e3);c>0?o("".concat(r," : ").concat(s," : ").concat(a," : ").concat(i)):(clearInterval(e),o("Already launched"))}}),1e3);return function(){return clearInterval(e)}}),[t]),Object(u.jsxs)("div",{className:"upcoming",children:[r&&Object(u.jsx)("div",{children:r}),n&&Object(u.jsx)("div",{children:"Loading..."}),t&&Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{className:"countdown",children:l}),Object(u.jsx)("p",{children:"Days Hours Minutes Seconds"}),Object(u.jsxs)("p",{children:["Until ",t[0].name," mission"]})]})]})},h=function(){var e,t=d("https://api.spacexdata.com/v5/launches"),n=t.data,c=t.isPending,r=t.error;return n&&(e=n.filter((function(e){return e.details}))),Object(u.jsxs)("div",{className:"home",children:[Object(u.jsx)(b,{}),r&&Object(u.jsx)("div",{children:r}),c&&Object(u.jsx)("div",{children:"Loading..."}),n&&Object(u.jsx)(j,{launches:e})]})},O=function(e){var t=e.crewMember,n=d("https://api.spacexdata.com/v4/crew/"+t.crew),c=n.data,r=n.isPending,s=n.error;return Object(u.jsxs)("div",{className:"crew-member",children:[r&&Object(u.jsx)("div",{children:"Loading..."}),s&&Object(u.jsx)("div",{children:s}),c&&Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"member-image-container",children:Object(u.jsx)("img",{className:"crew-image",src:c.image,alt:c.name})}),Object(u.jsx)("p",{children:c.name}),Object(u.jsx)("p",{children:t.role})]})]})},m=function(e){var t=e.crewMembers;return Object(u.jsx)("div",{className:"crew-details",children:t.map((function(e,t){return Object(u.jsx)("div",{className:"crew-detail",children:Object(u.jsx)(O,{crewMember:e})},t)}))})},x=n(4),p=n.n(x),v=n(8),f=Object(c.createContext)(null),g=function(e){var t=e.post_id,n=d("http://localhost:8000/comment/"+t),r=n.data,s=n.isPending,a=n.error,l=Object(c.useState)(""),o=Object(i.a)(l,2),j=o[0],b=o[1],h=Object(c.useContext)(f).user,O=function(e){var t=e.createdAt.substring(0,10),n=new Date(e.createdAt),c=""+n.getMinutes();1===c.length&&(c="0"+c);var r="".concat(n.getHours(),":").concat(c);return"".concat(t," ").concat(r)},m=function(){var e=Object(v.a)(p.a.mark((function e(){var n,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={content:j,user:h,post_id:t},e.prev=1,e.next=4,fetch("http://localhost:8000/comment",{method:"POST",credentials:"include",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});case 4:return c=e.sent,e.next=7,c.json();case 7:(s=e.sent).comment&&r.push(s.comment),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:b("");case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{className:"comment-section",children:[h&&Object(u.jsxs)("div",{className:"text-field-container",children:[Object(u.jsx)("h2",{children:"Discussion"}),Object(u.jsxs)("div",{className:"text-field",children:[Object(u.jsx)("textarea",{rows:"5",placeholder:"Write a comment",value:j,onChange:function(e){return b(e.target.value)}}),Object(u.jsx)("div",{className:"text-field-footer",children:Object(u.jsx)("button",{className:"btn",onClick:m,children:"Comment"})})]})]}),s&&Object(u.jsx)("div",{children:"Loading..."}),a&&Object(u.jsx)("div",{children:a}),r&&Object(u.jsx)("div",{className:"comments",children:r.map((function(e,t){return Object(u.jsxs)("div",{className:"comment",children:[Object(u.jsx)("p",{className:"comment-user",children:e.user}),Object(u.jsx)("p",{className:"comment-date-time",children:O(e)}),Object(u.jsx)("p",{className:"comment-content",children:e.content})]},t)}))})]})},w=function(){var e=Object(o.i)().id,t=d("https://api.spacexdata.com/v5/launches/"+e),n=t.data,r=t.isPending,s=t.error,a=Object(c.useState)(!1),l=Object(i.a)(a,2),j=l[0],b=l[1];return Object(c.useEffect)((function(){n&&0!==n.links.flickr.original.length&&function(e,t){var n=new Image;n.src=e,n.onload=function(){t(this.width,this.height)}}(n.links.flickr.original[0],(function(e,t){e/t>1&&b(!0)}))}),[n]),Object(u.jsxs)("div",{className:"launch-details",children:[r&&Object(u.jsx)("div",{children:"Loading..."}),s&&Object(u.jsx)("div",{children:s}),n&&Object(u.jsxs)("div",{children:[Object(u.jsxs)("article",{children:[Object(u.jsx)("h1",{children:n.name}),Object(u.jsx)("h4",{children:n.date_utc.substring(0,10)}),Object(u.jsx)("p",{children:n.details}),0!==n.links.flickr.original.length&&j&&Object(u.jsx)("img",{className:"rocket-image-h",src:n.links.flickr.original[0],alt:"launch"}),0!==n.links.flickr.original.length&&!j&&Object(u.jsx)("img",{className:"rocket-image-w",src:n.links.flickr.original[0],alt:"launch"}),0!==n.crew.length&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h2",{children:"Crew"}),Object(u.jsx)(m,{crewMembers:n.crew})]})]}),Object(u.jsx)(g,{post_id:e})]})]})},S=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),a=Object(i.a)(s,2),l=a[0],j=a[1],d=Object(c.useState)({}),b=Object(i.a)(d,2),h=b[0],O=b[1],m=(Object(o.h)().state||{from:{pathname:"/"}}).from,x=Object(c.useContext)(f),g=x.user,w=x.setUser,S=function(){var e=Object(v.a)(p.a.mark((function e(t){var c,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O({}),c={email:n,password:l},e.prev=3,e.next=6,fetch("http://localhost:8000/login",{method:"POST",credentials:"include",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}});case 6:return r=e.sent,e.next=9,r.json();case 9:(s=e.sent).user&&(localStorage.setItem("user",s.user),w(s.user)),s.errors&&(O(s.errors),localStorage.removeItem("user"),w(null)),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0),localStorage.removeItem("user"),w(null);case 19:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return g?Object(u.jsx)(o.a,{to:m}):Object(u.jsxs)("div",{className:"login",children:[Object(u.jsx)("h2",{children:"Login"}),Object(u.jsxs)("form",{onSubmit:S,children:[Object(u.jsx)("label",{children:"Email"}),Object(u.jsx)("input",{type:"text",required:!0,value:n,onChange:function(e){return r(e.target.value)}}),h.email&&Object(u.jsx)("div",{children:h.email}),Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{type:"password",required:!0,value:l,onChange:function(e){return j(e.target.value)}}),h.password&&Object(u.jsx)("div",{children:h.password}),Object(u.jsx)("button",{children:"Login"})]})]})},N=function(){var e=Object(c.useContext)(f),t=e.user,n=e.setUser,r=Object(c.useState)("pending"),s=Object(i.a)(r,2),a=s[0],l=s[1];return Object(c.useEffect)((function(){var e=new AbortController;function c(){return c=Object(v.a)(p.a.mark((function e(c){var r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=20;break}return e.prev=1,e.next=4,fetch("http://localhost:8000/auth",{method:"POST",credentials:"include",signal:c.signal});case 4:return r=e.sent,e.next=7,r.json();case 7:(s=e.sent).user&&(n(s.user),localStorage.setItem("user",s.user),l("authenticated")),s.err&&(n(null),localStorage.removeItem("user"),l("unauthenticated")),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(1),"AbortError"===e.t0.name&&console.log("fetch aborted"),localStorage.removeItem("user"),l("unauthenticated"),n(null);case 18:e.next=23;break;case 20:l("unauthenticated"),n(null),localStorage.removeItem("user");case 23:case"end":return e.stop()}}),e,null,[[1,12]])}))),c.apply(this,arguments)}return function(e){c.apply(this,arguments)}(e),function(){return e.abort()}}),[t,n]),{auth:a}},k=function(){N();var e=Object(c.useContext)(f),t=e.user,n=e.setUser,r=Object(o.g)(),s=function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:8000/logout",{method:"GET",credentials:"include"});case 3:localStorage.removeItem("user"),n(null),r.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("nav",{className:"navbar",children:[Object(u.jsx)("h1",{children:"Launches"}),Object(u.jsxs)("div",{className:"links",children:[Object(u.jsx)(l.b,{to:"/",className:"nav-link",children:"Home"}),!t&&Object(u.jsxs)("div",{className:"authButtons",children:[Object(u.jsx)(l.b,{to:"/signup",children:Object(u.jsx)("button",{className:"btn",children:"Signup"})}),Object(u.jsx)(l.b,{to:"/login",children:Object(u.jsx)("button",{className:"btn",children:"Login"})})]}),t&&Object(u.jsx)("div",{className:"authButtons",children:Object(u.jsx)("button",{onClick:s,className:"btn logout-btn",children:"Logout"})})]})]})},y=n(14),C=n(18),I=["children"],P=function(e){var t=e.children,n=Object(C.a)(e,I),c=N().auth,r=Object(o.h)();return Object(u.jsx)(o.b,Object(y.a)(Object(y.a)({},n),{},{render:function(){return"authenticated"===c?t:"unauthenticated"===c?Object(u.jsx)(o.a,{to:{pathname:"/login",state:{from:r}}}):void 0}}))},M=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),a=Object(i.a)(s,2),l=a[0],j=a[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),h=b[0],O=b[1],m=Object(c.useState)({}),x=Object(i.a)(m,2),g=x[0],w=x[1],S=Object(o.g)(),N=Object(c.useContext)(f).setUser,k=function(){var e=Object(v.a)(p.a.mark((function e(t){var c,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),w({}),c={username:n,email:l,password:h},e.prev=3,e.next=6,fetch("http://localhost:8000/signup",{method:"POST",credentials:"include",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}});case 6:return r=e.sent,e.next=9,r.json();case 9:(s=e.sent).user&&(localStorage.setItem("user",s.user),N(s.user),S.push("/")),s.errors&&w(s.errors),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{className:"login",children:[Object(u.jsx)("h2",{children:"Signup"}),Object(u.jsxs)("form",{onSubmit:k,children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{type:"text",required:!0,value:n,onChange:function(e){return r(e.target.value)}}),g.username&&Object(u.jsx)("div",{children:g.username}),Object(u.jsx)("label",{children:"Email"}),Object(u.jsx)("input",{type:"text",required:!0,value:l,onChange:function(e){return j(e.target.value)}}),g.email&&Object(u.jsx)("div",{children:g.email}),Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{type:"password",required:!0,value:h,onChange:function(e){return O(e.target.value)}}),g.password&&Object(u.jsx)("div",{children:g.password}),Object(u.jsx)("button",{children:"Signup"})]})]})};var E=function(){var e=Object(c.useState)(localStorage.getItem("user")),t=Object(i.a)(e,2),n=t[0],r=t[1],s=Object(c.useMemo)((function(){return{user:n,setUser:r}}),[n,r]);return Object(u.jsx)(l.a,{children:Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(f.Provider,{value:s,children:[Object(u.jsx)(k,{}),Object(u.jsx)("div",{className:"content",children:Object(u.jsxs)(o.d,{children:[Object(u.jsx)(o.b,{exact:!0,path:"/",children:Object(u.jsx)(h,{})}),Object(u.jsx)(o.b,{path:"/launch/:id",children:Object(u.jsx)(w,{})}),Object(u.jsx)(o.b,{path:"/signup",children:Object(u.jsx)(M,{})}),Object(u.jsx)(o.b,{path:"/login",children:Object(u.jsx)(S,{})}),Object(u.jsx)(P,{path:"/random",children:Object(u.jsx)("h2",{children:"Hello"})})]})})]})})})};a.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(E,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.38c07460.chunk.js.map